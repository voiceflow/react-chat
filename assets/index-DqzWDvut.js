import{j as U}from"./jsx-runtime-DRTy3Uxn.js";import{i as gt,c as ht}from"./device-WPWeBsw9.js";import{r as z,g as dt}from"./index-BBkUAzwr.js";import{B as oe}from"./index-60JQpial.js";import{t as Ie,T as ee,a as Ee}from"./index-CcHdfiB1.js";import{c as vt}from"./functional-ii7S4iDS.js";import{I as W}from"./index-D1YpC07r.js";import{C as mt}from"./constants-CnzOgqsw.js";import{t as bt}from"./tag-CD_1nE8q.js";import{s as ce}from"./animation-I98MwHEk.js";const ue=bt(mt.CHAT_INPUT),te=ce(ue("label","button"),{...Ie,display:"inline-flex",justifyContent:"center",alignItems:"center",paddingBottom:"8px",width:"$md",borderRadius:"$1",boxSizing:"border-box",cursor:"text",pointerEvents:"none",[`& ${oe.Container}`]:{transform:"scale(0)",marginTop:"auto",trans:["background-color","transform"]},variants:{ready:{true:{[`& ${oe.Container}`]:{transform:"scale(1)",cursor:"pointer",pointerEvents:"all"}}}}}),ze=ce(ue("div"),{display:"flex",boxShadow:"0 1px 12px $shadow2",trans:["border-color","box-shadow"],position:"relative",[`& ${ee.Container}`]:{...Ie,minHeight:"$md",margin:0,borderRightWidth:0,borderTopRightRadius:0,borderBottomRightRadius:0,paddingRight:7,boxShadow:"none"},[`& ${te}`]:{height:"inherit",borderLeftWidth:0,borderTopLeftRadius:0,borderBottomLeftRadius:0},[`& ${W.Frame}`]:{color:"$white"},[`& ${ee.Container}:focus`]:{...Ee,borderRightWidth:0},[`& ${ee.Container}:focus + ${te}`]:{...Ee,borderLeftWidth:0}}),yt=ce(ue("button"),{width:"$md",position:"absolute",right:0,top:0,bottom:0,border:"none",background:"transparent",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",borderRadius:0,[`&& ${W.Frame}`]:{color:"$darkGrey",opacity:.8,trans:["opacity","color"]},"&:hover":{[`&& ${W.Frame}`]:{opacity:1}},"&:active":{[`&& ${W.Frame}`]:{color:"$black",opacity:1}},variants:{listening:{true:{[`&& ${W.Frame}`]:{color:"$warn"},"&:active":{[`&& ${W.Frame}`]:{color:"$warn"}}}},disabled:{true:{cursor:"not-allowed",[`&& ${W.Frame}`]:{opacity:.5}}}}}),se=({onStop:o,onStart:e,listening:t,processing:d,initializing:c})=>U.jsx(yt,{onClick:t?o:e,disabled:d||c,listening:t,children:U.jsx(W,{svg:t?"stop":"microphone"})});try{se.displayName="AudioInputButton",se.__docgenInfo={description:"",displayName:"AudioInputButton",props:{onStop:{defaultValue:null,description:"",name:"onStop",required:!0,type:{name:"() => void"}},onStart:{defaultValue:null,description:"",name:"onStart",required:!0,type:{name:"() => void"}},listening:{defaultValue:null,description:"",name:"listening",required:!0,type:{name:"boolean"}},processing:{defaultValue:null,description:"",name:"processing",required:!0,type:{name:"boolean"}},initializing:{defaultValue:null,description:"",name:"initializing",required:!0,type:{name:"boolean"}}}}}catch{}var le={},Ne={},k={};Object.defineProperty(k,"__esModule",{value:!0});k.browserSupportsPolyfills=k.compareTwoStringsUsingDiceCoefficient=k.commandToRegExp=k.concatTranscripts=k.debounce=void 0;var Rt=function(e,t,d){var c;return function(){var T=this,a=arguments,b=function(){c=null,d||e.apply(T,a)},v=d&&!c;clearTimeout(c),c=setTimeout(b,t),v&&e.apply(T,a)}};k.debounce=Rt;var St=function(){for(var e=arguments.length,t=new Array(e),d=0;d<e;d++)t[d]=arguments[d];return t.map(function(c){return c.trim()}).join(" ").trim()};k.concatTranscripts=St;var Tt=/\s*\((.*?)\)\s*/g,wt=/(\(\?:[^)]+\))\?/g,Ct=/(\(\?)?:\w+/g,_t=/\*/g,At=/[-{}[\]+?.,\\^$|#]/g,Lt=function(e){return e instanceof RegExp?new RegExp(e.source,"i"):(e=e.replace(At,"\\$&").replace(Tt,"(?:$1)?").replace(Ct,function(t,d){return d?t:"([^\\s]+)"}).replace(_t,"(.*?)").replace(wt,"\\s*$1?\\s*"),new RegExp("^"+e+"$","i"))};k.commandToRegExp=Lt;var Mt=function(e,t){if(e=e.replace(/\s+/g,"").toLowerCase(),t=t.replace(/\s+/g,"").toLowerCase(),!e.length&&!t.length)return 1;if(!e.length||!t.length)return 0;if(e===t)return 1;if(e.length===1&&t.length===1||e.length<2||t.length<2)return 0;for(var d=new Map,c=0;c<e.length-1;c++){var T=e.substring(c,c+2),a=d.has(T)?d.get(T)+1:1;d.set(T,a)}for(var b=0,v=0;v<t.length-1;v++){var g=t.substring(v,v+2),R=d.has(g)?d.get(g):0;R>0&&(d.set(g,R-1),b++)}return 2*b/(e.length+t.length-2)};k.compareTwoStringsUsingDiceCoefficient=Mt;var Pt=function(){return typeof window<"u"&&window.navigator!==void 0&&window.navigator.mediaDevices!==void 0&&window.navigator.mediaDevices.getUserMedia!==void 0&&(window.AudioContext!==void 0||window.webkitAudioContext!==void 0)};k.browserSupportsPolyfills=Pt;var H={},G={};Object.defineProperty(G,"__esModule",{value:!0});G.APPEND_TRANSCRIPT=G.CLEAR_TRANSCRIPT=void 0;var kt="CLEAR_TRANSCRIPT";G.CLEAR_TRANSCRIPT=kt;var Et="APPEND_TRANSCRIPT";G.APPEND_TRANSCRIPT=Et;Object.defineProperty(H,"__esModule",{value:!0});H.appendTranscript=H.clearTranscript=void 0;var De=G,$t=function(){return{type:De.CLEAR_TRANSCRIPT}};H.clearTranscript=$t;var Ot=function(e,t){return{type:De.APPEND_TRANSCRIPT,payload:{interimTranscript:e,finalTranscript:t}}};H.appendTranscript=Ot;var ie={};Object.defineProperty(ie,"__esModule",{value:!0});ie.transcriptReducer=void 0;var $e=G,It=k,zt=function(e,t){switch(t.type){case $e.CLEAR_TRANSCRIPT:return{interimTranscript:"",finalTranscript:""};case $e.APPEND_TRANSCRIPT:return{interimTranscript:t.payload.interimTranscript,finalTranscript:(0,It.concatTranscripts)(e.finalTranscript,t.payload.finalTranscript)};default:throw new Error}};ie.transcriptReducer=zt;var Fe={},pe={};(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var e=function(){return/(android)/i.test(typeof navigator<"u"?navigator.userAgent:"")};o.default=e})(pe);var fe={};(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=o.isNative=void 0;var e=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),t=function(T){return T===e};o.isNative=t;var d=e;o.default=d})(fe);(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var e=c(pe),t=k,d=fe;function c(m){return m&&m.__esModule?m:{default:m}}function T(m,s,n,i,p,l,h){try{var w=m[l](h),P=w.value}catch(j){n(j);return}w.done?s(P):Promise.resolve(P).then(i,p)}function a(m){return function(){var s=this,n=arguments;return new Promise(function(i,p){var l=m.apply(s,n);function h(P){T(l,i,p,h,w,"next",P)}function w(P){T(l,i,p,h,w,"throw",P)}h(void 0)})}}function b(m,s){if(!(m instanceof s))throw new TypeError("Cannot call a class as a function")}function v(m,s){for(var n=0;n<s.length;n++){var i=s[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(m,i.key,i)}}function g(m,s,n){return s&&v(m.prototype,s),n&&v(m,n),m}var R=function(){function m(s){b(this,m),this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=function(){},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(s),(0,e.default)()&&(this.updateFinalTranscript=(0,t.debounce)(this.updateFinalTranscript,250,!0))}return g(m,[{key:"setSpeechRecognition",value:function(n){var i=!!n&&((0,d.isNative)(n)||(0,t.browserSupportsPolyfills)());i&&(this.disableRecognition(),this.recognition=new n,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(i)}},{key:"subscribe",value:function(n,i){this.subscribers[n]=i}},{key:"unsubscribe",value:function(n){delete this.subscribers[n]}},{key:"emitListeningChange",value:function(n){var i=this;this.listening=n,Object.keys(this.subscribers).forEach(function(p){var l=i.subscribers[p].onListeningChange;l(n)})}},{key:"emitMicrophoneAvailabilityChange",value:function(n){var i=this;this.isMicrophoneAvailable=n,Object.keys(this.subscribers).forEach(function(p){var l=i.subscribers[p].onMicrophoneAvailabilityChange;l(n)})}},{key:"emitTranscriptChange",value:function(n,i){var p=this;Object.keys(this.subscribers).forEach(function(l){var h=p.subscribers[l].onTranscriptChange;h(n,i)})}},{key:"emitClearTranscript",value:function(){var n=this;Object.keys(this.subscribers).forEach(function(i){var p=n.subscribers[i].onClearTranscript;p()})}},{key:"emitBrowserSupportsSpeechRecognitionChange",value:function(n){var i=this;Object.keys(this.subscribers).forEach(function(p){var l=i.subscribers[p],h=l.onBrowserSupportsSpeechRecognitionChange,w=l.onBrowserSupportsContinuousListeningChange;h(n),w(n)})}},{key:"disconnect",value:function(n){if(this.recognition&&this.listening)switch(n){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;case"STOP":default:this.pauseAfterDisconnect=!0,this.stop()}}},{key:"disableRecognition",value:function(){this.recognition&&(this.recognition.onresult=function(){},this.recognition.onend=function(){},this.recognition.onerror=function(){},this.listening&&this.stopListening())}},{key:"onError",value:function(n){n&&n.error&&n.error==="not-allowed"&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}},{key:"onRecognitionDisconnect",value:function(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}},{key:"updateTranscript",value:function(n){var i=n.results,p=n.resultIndex,l=p===void 0?i.length-1:p;this.interimTranscript="",this.finalTranscript="";for(var h=l;h<i.length;++h)i[h].isFinal&&(!(0,e.default)()||i[h][0].confidence>0)?this.updateFinalTranscript(i[h][0].transcript):this.interimTranscript=(0,t.concatTranscripts)(this.interimTranscript,i[h][0].transcript);var w=!1;this.interimTranscript===""&&this.finalTranscript!==""?(this.previousResultWasFinalOnly&&(w=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,w||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}},{key:"updateFinalTranscript",value:function(n){this.finalTranscript=(0,t.concatTranscripts)(this.finalTranscript,n)}},{key:"resetTranscript",value:function(){this.disconnect("RESET")}},{key:"startListening",value:function(){var s=a(regeneratorRuntime.mark(function i(){var p,l,h,w,P,j,K=arguments;return regeneratorRuntime.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(p=K.length>0&&K[0]!==void 0?K[0]:{},l=p.continuous,h=l===void 0?!1:l,w=p.language,this.recognition){C.next=3;break}return C.abrupt("return");case 3:if(P=h!==this.recognition.continuous,j=w&&w!==this.recognition.lang,!(P||j)){C.next=11;break}if(!this.listening){C.next=9;break}return C.next=9,this.stopListening();case 9:this.recognition.continuous=P?h:this.recognition.continuous,this.recognition.lang=j?w:this.recognition.lang;case 11:if(this.listening){C.next=22;break}return this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript()),C.prev=13,C.next=16,this.start();case 16:this.emitListeningChange(!0),C.next=22;break;case 19:C.prev=19,C.t0=C.catch(13),C.t0 instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1);case 22:case"end":return C.stop()}},i,this,[[13,19]])}));function n(){return s.apply(this,arguments)}return n}()},{key:"abortListening",value:function(){var s=a(regeneratorRuntime.mark(function i(){var p=this;return regeneratorRuntime.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return this.disconnect("ABORT"),this.emitListeningChange(!1),h.next=4,new Promise(function(w){p.onStopListening=w});case 4:case"end":return h.stop()}},i,this)}));function n(){return s.apply(this,arguments)}return n}()},{key:"stopListening",value:function(){var s=a(regeneratorRuntime.mark(function i(){var p=this;return regeneratorRuntime.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return this.disconnect("STOP"),this.emitListeningChange(!1),h.next=4,new Promise(function(w){p.onStopListening=w});case 4:case"end":return h.stop()}},i,this)}));function n(){return s.apply(this,arguments)}return n}()},{key:"getRecognition",value:function(){return this.recognition}},{key:"start",value:function(){var s=a(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(this.recognition&&!this.listening)){l.next=4;break}return l.next=3,this.recognition.start();case 3:this.listening=!0;case 4:case"end":return l.stop()}},i,this)}));function n(){return s.apply(this,arguments)}return n}()},{key:"stop",value:function(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}},{key:"abort",value:function(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}}]),m}();o.default=R})(Fe);(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=o.useSpeechRecognition=void 0;var e=z,t=k,d=H,c=ie,T=v(Fe),a=v(pe),b=v(fe);function v(r){return r&&r.__esModule?r:{default:r}}function g(r,f,u,y,_,S,A){try{var L=r[S](A),$=L.value}catch(F){u(F);return}L.done?f($):Promise.resolve($).then(y,_)}function R(r){return function(){var f=this,u=arguments;return new Promise(function(y,_){var S=r.apply(f,u);function A($){g(S,y,_,A,L,"next",$)}function L($){g(S,y,_,A,L,"throw",$)}A(void 0)})}}function m(r){return i(r)||n(r)||w(r)||s()}function s(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n(r){if(typeof Symbol<"u"&&Symbol.iterator in Object(r))return Array.from(r)}function i(r){if(Array.isArray(r))return P(r)}function p(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?p=function(u){return typeof u}:p=function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},p(r)}function l(r,f){return K(r)||j(r,f)||w(r,f)||h()}function h(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w(r,f){if(r){if(typeof r=="string")return P(r,f);var u=Object.prototype.toString.call(r).slice(8,-1);if(u==="Object"&&r.constructor&&(u=r.constructor.name),u==="Map"||u==="Set")return Array.from(r);if(u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u))return P(r,f)}}function P(r,f){(f==null||f>r.length)&&(f=r.length);for(var u=0,y=new Array(f);u<f;u++)y[u]=r[u];return y}function j(r,f){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(r)))){var u=[],y=!0,_=!1,S=void 0;try{for(var A=r[Symbol.iterator](),L;!(y=(L=A.next()).done)&&(u.push(L.value),!(f&&u.length===f));y=!0);}catch($){_=!0,S=$}finally{try{!y&&A.return!=null&&A.return()}finally{if(_)throw S}}return u}}function K(r){if(Array.isArray(r))return r}var q=!!b.default,C=q&&!(0,a.default)(),N,Be=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=f.transcribing,y=u===void 0?!0:u,_=f.clearTranscriptOnListen,S=_===void 0?!0:_,A=f.commands,L=A===void 0?[]:A,$=(0,e.useState)(D.getRecognitionManager()),F=l($,1),B=F[0],We=(0,e.useState)(q),ge=l(We,2),je=ge[0],qe=ge[1],Ve=(0,e.useState)(C),he=l(Ve,2),Ue=he[0],Ge=he[1],He=(0,e.useReducer)(c.transcriptReducer,{interimTranscript:B.interimTranscript,finalTranscript:""}),de=l(He,2),ve=de[0],me=ve.interimTranscript,be=ve.finalTranscript,ye=de[1],Ke=(0,e.useState)(B.listening),Re=l(Ke,2),Je=Re[0],Qe=Re[1],Xe=(0,e.useState)(B.isMicrophoneAvailable),Se=l(Xe,2),Ye=Se[0],Ze=Se[1],Te=(0,e.useRef)(L);Te.current=L;var we=function(){ye((0,d.clearTranscript)())},J=(0,e.useCallback)(function(){B.resetTranscript(),we()},[B]),et=function(M,I,V){var x=p(M)==="object"?M.toString():M,Q=x.replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),X=(0,t.compareTwoStringsUsingDiceCoefficient)(Q,I);return X>=V?{command:M,commandWithoutSpecials:Q,howSimilar:X,isFuzzyMatch:!0}:null},tt=function(M,I){var V=(0,t.commandToRegExp)(M),x=V.exec(I);return x?{command:M,parameters:x.slice(1)}:null},Ce=(0,e.useCallback)(function(O,M){Te.current.forEach(function(I){var V=I.command,x=I.callback,Q=I.matchInterim,X=Q===void 0?!1:Q,Le=I.isFuzzyMatch,Me=Le===void 0?!1:Le,Pe=I.fuzzyMatchingThreshold,it=Pe===void 0?.8:Pe,ke=I.bestMatchOnly,rt=ke===void 0?!1:ke,Y=!M&&X?O.trim():M.trim(),at=Array.isArray(V)?V:[V],Z=at.map(function(E){return Me?et(E,Y,it):tt(E,Y)}).filter(function(E){return E});if(Me&&rt&&Z.length>=2){Z.sort(function(E,ae){return ae.howSimilar-E.howSimilar});var re=Z[0],ot=re.command,st=re.commandWithoutSpecials,ct=re.howSimilar;x(st,Y,ct,{command:ot,resetTranscript:J})}else Z.forEach(function(E){if(E.isFuzzyMatch){var ae=E.command,ut=E.commandWithoutSpecials,lt=E.howSimilar;x(ut,Y,lt,{command:ae,resetTranscript:J})}else{var pt=E.command,ft=E.parameters;x.apply(void 0,m(ft).concat([{command:pt,resetTranscript:J}]))}})})},[J]),_e=(0,e.useCallback)(function(O,M){y&&ye((0,d.appendTranscript)(O,M)),Ce(O,M)},[Ce,y]),Ae=(0,e.useCallback)(function(){S&&we()},[S]);(0,e.useEffect)(function(){var O=D.counter;D.counter+=1;var M={onListeningChange:Qe,onMicrophoneAvailabilityChange:Ze,onTranscriptChange:_e,onClearTranscript:Ae,onBrowserSupportsSpeechRecognitionChange:qe,onBrowserSupportsContinuousListeningChange:Ge};return B.subscribe(O,M),function(){B.unsubscribe(O)}},[y,S,B,_e,Ae]);var nt=(0,t.concatTranscripts)(be,me);return{transcript:nt,interimTranscript:me,finalTranscript:be,listening:Je,isMicrophoneAvailable:Ye,resetTranscript:J,browserSupportsSpeechRecognition:je,browserSupportsContinuousListening:Ue}};o.useSpeechRecognition=Be;var D={counter:0,applyPolyfill:function(f){N?N.setSpeechRecognition(f):N=new T.default(f);var u=!!f&&(0,t.browserSupportsPolyfills)();q=u,C=u},removePolyfill:function(){N?N.setSpeechRecognition(b.default):N=new T.default(b.default),q=!!b.default,C=q&&!(0,a.default)()},getRecognitionManager:function(){return N||(N=new T.default(b.default)),N},getRecognition:function(){var f=D.getRecognitionManager();return f.getRecognition()},startListening:function(){var r=R(regeneratorRuntime.mark(function u(){var y,_,S,A,L=arguments;return regeneratorRuntime.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return y=L.length>0&&L[0]!==void 0?L[0]:{},_=y.continuous,S=y.language,A=D.getRecognitionManager(),F.next=4,A.startListening({continuous:_,language:S});case 4:case"end":return F.stop()}},u)}));function f(){return r.apply(this,arguments)}return f}(),stopListening:function(){var r=R(regeneratorRuntime.mark(function u(){var y;return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return y=D.getRecognitionManager(),S.next=3,y.stopListening();case 3:case"end":return S.stop()}},u)}));function f(){return r.apply(this,arguments)}return f}(),abortListening:function(){var r=R(regeneratorRuntime.mark(function u(){var y;return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return y=D.getRecognitionManager(),S.next=3,y.abortListening();case 3:case"end":return S.stop()}},u)}));function f(){return r.apply(this,arguments)}return f}(),browserSupportsSpeechRecognition:function(){return q},browserSupportsContinuousListening:function(){return C}},xe=D;o.default=xe})(Ne);(function(o){function e(a){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?e=function(v){return typeof v}:e=function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},e(a)}Object.defineProperty(o,"__esModule",{value:!0}),Object.defineProperty(o,"useSpeechRecognition",{enumerable:!0,get:function(){return t.useSpeechRecognition}}),o.default=void 0;var t=c(Ne);function d(){if(typeof WeakMap!="function")return null;var a=new WeakMap;return d=function(){return a},a}function c(a){if(a&&a.__esModule)return a;if(a===null||e(a)!=="object"&&typeof a!="function")return{default:a};var b=d();if(b&&b.has(a))return b.get(a);var v={},g=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in a)if(Object.prototype.hasOwnProperty.call(a,R)){var m=g?Object.getOwnPropertyDescriptor(a,R):null;m&&(m.get||m.set)?Object.defineProperty(v,R,m):v[R]=a[R]}return v.default=a,b&&b.set(a,v),v}var T=t.default;o.default=T})(le);const Oe=dt(le),Nt=({onSend:o,onValueChange:e,customSpeechRecognition:t})=>{const d=z.useRef(null),c=le.useSpeechRecognition({clearTranscriptOnListen:!0}),T=c.browserSupportsSpeechRecognition&&gt(),a=!!t&&(t.overrideNative||!T),b=z.useRef(a?t.initialState.listening:c.listening),v=z.useRef(a?t.initialState.processing:!1),g=z.useRef(o);g.current=o;const[R,m]=z.useState(a?t.initialState:{listening:c.listening,transcript:c.transcript,processing:!1,initializing:!1,microphoneAvailable:c.isMicrophoneAvailable}),s=()=>{a?(t.resetTranscript(),t.startListening()):(c.resetTranscript(),Oe.startListening({continuous:!0}))},n=()=>{a?t.stopListening():Oe.stopListening()};return z.useLayoutEffect(()=>{a||!c.listening||e(c.transcript)},[a,c.transcript]),z.useEffect(()=>{var i,p,l,h;a?(v.current&&!R.processing&&((i=g.current)==null||i.call(g),t.resetTranscript(),(p=d.current)==null||p.focus()),v.current=R.processing):(b.current&&!c.listening&&((l=g.current)==null||l.call(g),c.resetTranscript(),(h=d.current)==null||h.focus()),b.current=c.listening)},[a,c.listening,R.processing]),z.useEffect(()=>{if(a)return t.onStateChange(i=>{e(i.transcript),m(i)})},[a]),{available:a||T,listening:a?R.listening:c.listening,processing:a?R.processing:!1,textareaRef:d,initializing:a?R.initializing:!1,stopListening:n,startListening:s,microphoneAvailable:a?R.microphoneAvailable:c.isMicrophoneAvailable}},ne=({id:o,onSend:e,placeholder:t,disableSend:d,onValueChange:c,audioInterface:T,speechRecognition:a,...b})=>{const v=z.useMemo(()=>`vf-chat-input--${ht()}`,[])??o,g=Nt({onSend:e,onValueChange:c,customSpeechRecognition:a}),R=i=>{i.stopPropagation();const{shiftKey:p}=i;i.key==="Enter"&&i.key==="Enter"&&!p&&(i.preventDefault(),e==null||e())},m=!!b.value&&!d&&!g.listening,s=g.available&&g.microphoneAvailable&&T&&!m,n=()=>g.initializing?"Initializing...":g.listening?"Listening...":g.processing?"Processing...":t;return U.jsxs(ze,{children:[U.jsx(ee,{id:v,ref:g.textareaRef,readOnly:g.initializing||g.processing||g.listening,onKeyDown:R,placeholder:n(),onValueChange:c,...b}),U.jsx(te,{htmlFor:v,ready:m,children:U.jsx(oe,{size:"small",svg:"smallArrowUp",onClick:e})}),s&&U.jsx(se,{onStop:g.stopListening,onStart:g.startListening,listening:g.listening,processing:g.processing,initializing:g.initializing})]})},Ht=Object.assign(ne,{Controlled:vt(ne,{defaultValue:"",enrichProps:(o,[,e])=>({...o,onSend:()=>{var t;e(""),(t=o.onSend)==null||t.call(o)}})}),Container:ze,ButtonContainer:te});try{ne.displayName="ChatInput",ne.__docgenInfo={description:"An input control with a built-in submit button.",displayName:"ChatInput",props:{disableSend:{defaultValue:null,description:"If true, does not allow the user to submit a response.",name:"disableSend",required:!1,type:{name:"boolean"}},audioInterface:{defaultValue:null,description:"if true, shows audio interface controls.",name:"audioInterface",required:!1,type:{name:"boolean"}},onSend:{defaultValue:null,description:"A callback to submit the user response.",name:"onSend",required:!1,type:{name:"VoidFunction"}},speechRecognition:{defaultValue:null,description:"Custom speech recognition implementation.",name:"speechRecognition",required:!1,type:{name:"{ overrideNative?: boolean; initialState?: { listening?: boolean; transcript?: string; processing?: boolean; initializing?: boolean; microphoneAvailable?: boolean; }; onStateChange?: (args_0: (args_0: { listening?: boolean; transcript?: string; processing?: boolean; initializing?: boolean; microphoneAvailable?: bool..."}},value:{defaultValue:null,description:"The value being controlled by the component.",name:"value",required:!0,type:{name:"string"}},onValueChange:{defaultValue:null,description:"A callback that will be called with new values when the control is updated.",name:"onValueChange",required:!0,type:{name:"(value: string) => void"}}}}}catch{}export{Ht as C};
