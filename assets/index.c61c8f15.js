import{a as R,j as c,r as f,F as ue,R as Nt}from"./jsx-runtime.e4513c7f.js";import{R as Pe,a as re,S as Le,A as Vt,D as De,F as me,M as Q,b as Yt,c as Pt}from"./index.beaa3123.js";import"./index.484a71f2.js";import{A as G}from"./index.42d6d440.js";import{t as H,C as F}from"./tag.68cc90a9.js";import{s as C,f as Ht,a as rt,c as Ft}from"./animation.fa179f78.js";import{B as J}from"./index.351b6450.js";import{C as qt}from"./index.8264098b.js";import{I as Ut}from"./index.90d4a3ec.js";import{I as z,S as Xe}from"./index.9a4919dd.js";import{L as ot}from"./index.281c3821.js";import{c as jt}from"./functional.8db3b2e6.js";import{c as st}from"./iframe.97a9dd79.js";import{T as Wt}from"./index.debfcdc4.js";import{M as ne}from"./index.738c95ab.js";import{T as ee}from"./index.10f199fd.js";import{C as He,a as Kt}from"./index.d2c1aac9.js";import{r as zt}from"./index.22a93914.js";import{I as Gt}from"./index.b7a3fb7e.js";import{D as Jt}from"./index.115fc372.js";import{T as at}from"./index.bf3459e3.js";var Xt=globalThis&&globalThis.__spreadArray||function(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,o;n<i;n++)(o||!(n in t))&&(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))};function Zt(e,t,r){var n=e.length-t.length,i=Array.from(t);if(n===0)return e.apply(void 0,i);if(n===1){var o=function(u){return e.apply(void 0,Xt([u],i,!1))};return(r||e.lazy)&&(o.lazy=r||e.lazy,o.lazyArgs=t),o}throw new Error("Wrong number of arguments")}function Ze(){return Zt(Qt,arguments)}function Qt(e,t){var r=new Set(t);return Object.entries(e).reduce(function(n,i){var o=i[0],u=i[1];return r.has(o)||(n[o]=u),n},{})}const it={overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},Fe=H(F.ASSISTANT_INFO),qe=C(Fe("h2","title"),{...it,width:"100%",margin:0,typo:{size:20,weight:"$2",height:"$3"},color:"$black"}),lt=C(Fe("p","description"),{display:"-webkit-box",margin:0,typo:{},color:"$darkGrey","-webkit-line-clamp":2,"-webkit-box-orient":"vertical",overflow:"hidden",wordBreak:"break-word"}),ct=C(Fe("div"),{display:"flex",flexDirection:"column",alignItems:"center",padding:"48px 32px",textAlign:"center",[`& ${G.Container}`]:{marginBottom:"$4"},[`& ${qe}`]:{marginBottom:8}}),ge=({title:e,description:t,avatar:r})=>R(ct,{children:[c(G,{size:"large",avatar:r}),c(qe,{children:e}),c(lt,{children:t})]}),dt=Object.assign(ge,{Container:ct,Title:qe,Description:lt});try{ge.displayName="AssistantInfo",ge.__docgenInfo={description:`This component displays introductory information about the assistant.
It will act as a placeholder before the conversation has started.`,displayName:"AssistantInfo",props:{title:{defaultValue:null,description:"The title of the assistant.",name:"title",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"A short description of the assistant to help frame the conversation.",name:"description",required:!0,type:{name:"string"}},avatar:{defaultValue:null,description:"An image URL that identifies the assistant, such as a brand icon.",name:"avatar",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/components/AssistantInfo/index.tsx#AssistantInfo"]={docgenInfo:ge.__docgenInfo,name:"AssistantInfo",path:"src/components/AssistantInfo/index.tsx#AssistantInfo"})}catch{}const ut=H(F.FOOTER),pt=C(ut("footer"),{padding:"$3 $4 $4 $4",borderRadius:"$1",[`& ${Ut.Container}`]:{flex:1},[`& ${J.Container}`]:{width:"100%"},variants:{withShadow:{true:{boxShadow:"0 12px 48px $shadow16"}},withWatermark:{true:{paddingBottom:"0"}}}}),ht=C(ut("aside","watermark"),{display:"flex",justifyContent:"center",alignItems:"center",padding:"10px 0 $3 0",typo:{size:12,height:"17px"},color:"$darkGrey","& a":{marginLeft:"0.5ch",textDecoration:"none",color:"$blue","&:focus":{outline:0}}}),ye=({withWatermark:e,hasEnded:t,onStart:r,onSend:n})=>{const[i,o]=f.exports.useState(""),[u,$]=f.exports.useState(!1),{session:x}=f.exports.useContext(Pe),{config:d}=f.exports.useContext(re),{autostart:g}=d,S=async()=>{!i||u||($(!0),o(""),await(n==null?void 0:n(i)),$(!1))};return R(pt,{withShadow:!!t||!g&&x.status===Le.IDLE,withWatermark:e,children:[t||!g&&x.status===Le.IDLE?c(J,{onClick:r,children:"Start New Chat"}):c(qt,{value:i,placeholder:"Message\u2026",autoFocus:!0,onValueChange:o,onSend:S,buffering:u}),e&&R(ht,{children:["Assistant \u26A1\uFE0F by",c("a",{target:"_blank",href:"https://voiceflow.com",rel:"noreferrer",children:"Voiceflow"})]})]})},mt=Object.assign(ye,{Container:pt,Watermark:ht});try{ye.displayName="Footer",ye.__docgenInfo={description:"Footer for the chat widget; displays input controls or a prompt to restart the conversation.",displayName:"Footer",props:{withWatermark:{defaultValue:null,description:"If true, shows a watermark indicating that the conversation is powered by Voiceflow.",name:"withWatermark",required:!0,type:{name:"boolean"}},hasEnded:{defaultValue:null,description:`If true, shows a prompt to start a new chat by calling the {@link onStart} handler.
If false, renders controls for the user to write a response.`,name:"hasEnded",required:!1,type:{name:"boolean"}},onStart:{defaultValue:null,description:"A callback to start a new conversation.",name:"onStart",required:!1,type:{name:"() => Promise<void>"}},onSend:{defaultValue:null,description:"A callback to submit a user response.",name:"onSend",required:!1,type:{name:"(message: string) => Promise<void>"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/components/Footer/index.tsx#Footer"]={docgenInfo:ye.__docgenInfo,name:"Footer",path:"src/components/Footer/index.tsx#Footer"})}catch{}const Ue=H(F.HEADER),je=C(Ue("h1","title"),{...it,typo:{size:17,weight:"$2",height:"$2"},color:"rgba(255,255,255,0.95)"}),ft=C(Ue(J.Reset,"button"),{display:"flex",justifyContent:"center",alignItems:"center",height:32,width:32,marginLeft:8,borderRadius:6,background:"none",trans:["background-color"],"&:hover":{backgroundColor:"rgba(255,255,255,0.16)",[`& ${z.Frame}`]:{color:"$white"}},[`& ${z.Frame}`]:{height:"$xxs",width:"$xxs",color:"rgba(255,255,255,0.8)",trans:["color"]}}),gt=C(Ue("header"),{display:"flex",flexShrink:0,alignItems:"center",height:"$lg",padding:"0 $4 0 $5",backgroundColor:"$primary",boxShadow:"0 1px 2px $shadow16",[`& ${G.Container}`]:{height:32,width:32},[`& ${je}`]:{flex:1,margin:"0 0 0 14px"}}),xe=({title:e,image:t,actions:r=[]})=>R(gt,{children:[c(G,{avatar:t}),c(je,{children:e}),r.map(({svg:n,onClick:i},o)=>c(ft,{onClick:i,children:c(z,{svg:n})},o))]}),yt=Object.assign(xe,{Container:gt,Title:je,Button:ft});try{xe.displayName="Header",xe.__docgenInfo={description:"Header for the chat widget with image, title and controls.",displayName:"Header",props:{title:{defaultValue:null,description:"The name of your assistant or title of the conversation.",name:"title",required:!0,type:{name:"string"}},image:{defaultValue:null,description:"An image URL that will be rendered as a small {@link Avatar}.",name:"image",required:!0,type:{name:"string"}},actions:{defaultValue:{value:"[]"},description:"A list of actions that will appear as icon buttons.",name:"actions",required:!1,type:{name:"HeaderActionProps[]"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/components/Header/index.tsx#Header"]={docgenInfo:xe.__docgenInfo,name:"Header",path:"src/components/Header/index.tsx#Header"})}catch{}const en=H(F.PROMPT),xt=C(en("div"),{padding:"$4 $4 $3 $4",borderRadius:"$1",backgroundColor:"$white",boxShadow:"0 12px 48px 4px $shadow12",[`& ${J.Container}`]:{width:"100%",marginTop:"$1","&:first-of-type":{marginTop:0}}}),Se=({accept:e,cancel:t})=>R(xt,{children:[c(J.Primary,{tabIndex:-1,...e,children:e.label}),c(J,{type:"subtle",tabIndex:-1,...t,children:t.label})]}),$e=Object.assign(Se,{Container:xt});try{Se.displayName="Prompt",Se.__docgenInfo={description:"A popup that prompts the user with cancel and accept actions.",displayName:"Prompt",props:{accept:{defaultValue:null,description:'Configuration for the "accept" action.',name:"accept",required:!0,type:{name:"PromptOptionProps"}},cancel:{defaultValue:null,description:'Configuration for the "cancel" action.',name:"cancel",required:!0,type:{name:"PromptOptionProps"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/components/Prompt/index.tsx#Prompt"]={docgenInfo:Se.__docgenInfo,name:"Prompt",path:"src/components/Prompt/index.tsx#Prompt"})}catch{}var St={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(st,function(){var r=1e3,n=6e4,i=36e5,o="millisecond",u="second",$="minute",x="hour",d="day",g="week",S="month",_="quarter",b="year",A="date",E="Invalid Date",V=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,q=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,U={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},X=function(y,l,s){var p=String(y);return!p||p.length>=l?y:""+Array(l+1-p.length).join(s)+y},N={s:X,z:function(y){var l=-y.utcOffset(),s=Math.abs(l),p=Math.floor(s/60),a=s%60;return(l<=0?"+":"-")+X(p,2,"0")+":"+X(a,2,"0")},m:function y(l,s){if(l.date()<s.date())return-y(s,l);var p=12*(s.year()-l.year())+(s.month()-l.month()),a=l.clone().add(p,S),m=s-a<0,h=l.clone().add(p+(m?-1:1),S);return+(-(p+(s-a)/(m?a-h:h-a))||0)},a:function(y){return y<0?Math.ceil(y)||0:Math.floor(y)},p:function(y){return{M:S,y:b,w:g,d,D:A,h:x,m:$,s:u,ms:o,Q:_}[y]||String(y||"").toLowerCase().replace(/s$/,"")},u:function(y){return y===void 0}},M="en",k={};k[M]=U;var D=function(y){return y instanceof pe},j=function y(l,s,p){var a;if(!l)return M;if(typeof l=="string"){var m=l.toLowerCase();k[m]&&(a=m),s&&(k[m]=s,a=m);var h=l.split("-");if(!a&&h.length>1)return y(h[0])}else{var v=l.name;k[v]=l,a=v}return!p&&a&&(M=a),a||!p&&M},I=function(y,l){if(D(y))return y.clone();var s=typeof l=="object"?l:{};return s.date=y,s.args=arguments,new pe(s)},w=N;w.l=j,w.i=D,w.w=function(y,l){return I(y,{locale:l.$L,utc:l.$u,x:l.$x,$offset:l.$offset})};var pe=function(){function y(s){this.$L=j(s.locale,null,!0),this.parse(s)}var l=y.prototype;return l.parse=function(s){this.$d=function(p){var a=p.date,m=p.utc;if(a===null)return new Date(NaN);if(w.u(a))return new Date;if(a instanceof Date)return new Date(a);if(typeof a=="string"&&!/Z$/i.test(a)){var h=a.match(V);if(h){var v=h[2]-1||0,O=(h[7]||"0").substring(0,3);return m?new Date(Date.UTC(h[1],v,h[3]||1,h[4]||0,h[5]||0,h[6]||0,O)):new Date(h[1],v,h[3]||1,h[4]||0,h[5]||0,h[6]||0,O)}}return new Date(a)}(s),this.$x=s.x||{},this.init()},l.init=function(){var s=this.$d;this.$y=s.getFullYear(),this.$M=s.getMonth(),this.$D=s.getDate(),this.$W=s.getDay(),this.$H=s.getHours(),this.$m=s.getMinutes(),this.$s=s.getSeconds(),this.$ms=s.getMilliseconds()},l.$utils=function(){return w},l.isValid=function(){return this.$d.toString()!==E},l.isSame=function(s,p){var a=I(s);return this.startOf(p)<=a&&a<=this.endOf(p)},l.isAfter=function(s,p){return I(s)<this.startOf(p)},l.isBefore=function(s,p){return this.endOf(p)<I(s)},l.$g=function(s,p,a){return w.u(s)?this[p]:this.set(a,s)},l.unix=function(){return Math.floor(this.valueOf()/1e3)},l.valueOf=function(){return this.$d.getTime()},l.startOf=function(s,p){var a=this,m=!!w.u(p)||p,h=w.p(s),v=function(te,L){var K=w.w(a.$u?Date.UTC(a.$y,L,te):new Date(a.$y,L,te),a);return m?K:K.endOf(d)},O=function(te,L){return w.w(a.toDate()[te].apply(a.toDate("s"),(m?[0,0,0,0]:[23,59,59,999]).slice(L)),a)},T=this.$W,B=this.$M,W=this.$D,Y="set"+(this.$u?"UTC":"");switch(h){case b:return m?v(1,0):v(31,11);case S:return m?v(1,B):v(0,B+1);case g:var ae=this.$locale().weekStart||0,ie=(T<ae?T+7:T)-ae;return v(m?W-ie:W+(6-ie),B);case d:case A:return O(Y+"Hours",0);case x:return O(Y+"Minutes",1);case $:return O(Y+"Seconds",2);case u:return O(Y+"Milliseconds",3);default:return this.clone()}},l.endOf=function(s){return this.startOf(s,!1)},l.$set=function(s,p){var a,m=w.p(s),h="set"+(this.$u?"UTC":""),v=(a={},a[d]=h+"Date",a[A]=h+"Date",a[S]=h+"Month",a[b]=h+"FullYear",a[x]=h+"Hours",a[$]=h+"Minutes",a[u]=h+"Seconds",a[o]=h+"Milliseconds",a)[m],O=m===d?this.$D+(p-this.$W):p;if(m===S||m===b){var T=this.clone().set(A,1);T.$d[v](O),T.init(),this.$d=T.set(A,Math.min(this.$D,T.daysInMonth())).$d}else v&&this.$d[v](O);return this.init(),this},l.set=function(s,p){return this.clone().$set(s,p)},l.get=function(s){return this[w.p(s)]()},l.add=function(s,p){var a,m=this;s=Number(s);var h=w.p(p),v=function(B){var W=I(m);return w.w(W.date(W.date()+Math.round(B*s)),m)};if(h===S)return this.set(S,this.$M+s);if(h===b)return this.set(b,this.$y+s);if(h===d)return v(1);if(h===g)return v(7);var O=(a={},a[$]=n,a[x]=i,a[u]=r,a)[h]||1,T=this.$d.getTime()+s*O;return w.w(T,this)},l.subtract=function(s,p){return this.add(-1*s,p)},l.format=function(s){var p=this,a=this.$locale();if(!this.isValid())return a.invalidDate||E;var m=s||"YYYY-MM-DDTHH:mm:ssZ",h=w.z(this),v=this.$H,O=this.$m,T=this.$M,B=a.weekdays,W=a.months,Y=function(L,K,Ee,he){return L&&(L[K]||L(p,m))||Ee[K].slice(0,he)},ae=function(L){return w.s(v%12||12,L,"0")},ie=a.meridiem||function(L,K,Ee){var he=L<12?"AM":"PM";return Ee?he.toLowerCase():he},te={YY:String(this.$y).slice(-2),YYYY:this.$y,M:T+1,MM:w.s(T+1,2,"0"),MMM:Y(a.monthsShort,T,W,3),MMMM:Y(W,T),D:this.$D,DD:w.s(this.$D,2,"0"),d:String(this.$W),dd:Y(a.weekdaysMin,this.$W,B,2),ddd:Y(a.weekdaysShort,this.$W,B,3),dddd:B[this.$W],H:String(v),HH:w.s(v,2,"0"),h:ae(1),hh:ae(2),a:ie(v,O,!0),A:ie(v,O,!1),m:String(O),mm:w.s(O,2,"0"),s:String(this.$s),ss:w.s(this.$s,2,"0"),SSS:w.s(this.$ms,3,"0"),Z:h};return m.replace(q,function(L,K){return K||te[L]||h.replace(":","")})},l.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},l.diff=function(s,p,a){var m,h=w.p(p),v=I(s),O=(v.utcOffset()-this.utcOffset())*n,T=this-v,B=w.m(this,v);return B=(m={},m[b]=B/12,m[S]=B,m[_]=B/3,m[g]=(T-O)/6048e5,m[d]=(T-O)/864e5,m[x]=T/i,m[$]=T/n,m[u]=T/r,m)[h]||T,a?B:w.a(B)},l.daysInMonth=function(){return this.endOf(S).$D},l.$locale=function(){return k[this.$L]},l.locale=function(s,p){if(!s)return this.$L;var a=this.clone(),m=j(s,p,!0);return m&&(a.$L=m),a},l.clone=function(){return w.w(this.$d,this)},l.toDate=function(){return new Date(this.valueOf())},l.toJSON=function(){return this.isValid()?this.toISOString():null},l.toISOString=function(){return this.$d.toISOString()},l.toString=function(){return this.$d.toUTCString()},y}(),Je=pe.prototype;return I.prototype=Je,[["$ms",o],["$s",u],["$m",$],["$H",x],["$W",d],["$M",S],["$y",b],["$D",A]].forEach(function(y){Je[y[1]]=function(l){return this.$g(l,y[0],y[1])}}),I.extend=function(y,l){return y.$i||(y(l,pe,I),y.$i=!0),I},I.locale=j,I.isDayjs=D,I.unix=function(y){return I(1e3*y)},I.en=k[M],I.Ls=k,I.p={},I})})(St);const Ne=St.exports;var $t={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(st,function(){return function(r,n,i){r=r||{};var o=n.prototype,u={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function $(d,g,S,_){return o.fromToBase(d,g,S,_)}i.en.relativeTime=u,o.fromToBase=function(d,g,S,_,b){for(var A,E,V,q=S.$locale().relativeTime||u,U=r.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],X=U.length,N=0;N<X;N+=1){var M=U[N];M.d&&(A=_?i(d).diff(S,M.d,!0):S.diff(d,M.d,!0));var k=(r.rounding||Math.round)(Math.abs(A));if(V=A>0,k<=M.r||!M.r){k<=1&&N>0&&(M=U[N-1]);var D=q[M.l];b&&(k=b(""+k)),E=typeof D=="string"?D.replace("%d",k):D(k,g,M.l,V);break}}if(g)return E;var j=V?q.future:q.past;return typeof j=="function"?j(E):j.replace("%s",E)},o.to=function(d,g){return $(d,g,this,!0)},o.from=function(d,g){return $(d,g,this)};var x=function(d){return d.$u?i.utc():i()};o.toNow=function(d){return this.to(x(this),d)},o.fromNow=function(d){return this.from(x(this),d)}}})})($t);const tn=$t.exports;Ne.extend(tn);const nn=e=>f.exports.useMemo(()=>{if(!e)return null;const t=Ne(e),r=Ne();switch(!0){case r.isSame(t,"day"):return"Today";case r.subtract(1,"day").isSame(t,"day"):return"Yesterday";default:return t.fromNow()}},[e]),Ct=(e=[])=>{const{scrollToBottom:t}=f.exports.useContext(Vt);f.exports.useLayoutEffect(()=>{t()},e)},rn=(e,t=[])=>{const r=f.exports.useRef(!1);f.exports.useEffect(()=>{if(r.current)return e();r.current=!0},t)},on=async(e,t)=>{const r=document.createElement("link"),n=new Promise((i,o)=>{r.onload=i,r.onerror=o});r.rel="stylesheet",r.href=e,t.appendChild(r),await n},sn=(e,t)=>{const[r,n]=f.exports.useState(!1);return f.exports.useEffect(()=>{if(!e||r||!t)return;if(!e.stylesheet){n(!0);return}const i=Array.isArray(e.stylesheet)?e.stylesheet[0]:e.stylesheet;(async()=>(await on(i,t).catch(o=>{console.error(`failed to load stylesheet: ${e.stylesheet}`),console.error(o)}),n(!0)))()},[e]),r},Me=e=>{const{shadowRoot:t}=f.exports.useContext(Pe);return sn(e,t)};try{Me.displayName="useLoadCustomTheme",Me.__docgenInfo={description:"",displayName:"useLoadCustomTheme",props:{}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/hooks/useLoadCustomTheme.tsx#useLoadCustomTheme"]={docgenInfo:Me.__docgenInfo,name:"useLoadCustomTheme",path:"src/hooks/useLoadCustomTheme.tsx#useLoadCustomTheme"})}catch{}const Ve=Symbol("@ts-pattern/matcher"),Qe="@ts-pattern/anonymous-select-key",et=e=>Boolean(e&&typeof e=="object"),ke=e=>e&&!!e[Ve],le=(e,t,r)=>{if(et(e)){if(ke(e)){const n=e[Ve](),{matched:i,selections:o}=n.match(t);return i&&o&&Object.keys(o).forEach(u=>r(u,o[u])),i}if(!et(t))return!1;if(Array.isArray(e))return!!Array.isArray(t)&&e.length===t.length&&e.every((n,i)=>le(n,t[i],r));if(e instanceof Map)return t instanceof Map&&Array.from(e.keys()).every(n=>le(e.get(n),t.get(n),r));if(e instanceof Set){if(!(t instanceof Set))return!1;if(e.size===0)return t.size===0;if(e.size===1){const[n]=Array.from(e.values());return ke(n)?Array.from(t.values()).every(i=>le(n,i,r)):t.has(n)}return Array.from(e.values()).every(n=>t.has(n))}return Object.keys(e).every(n=>{const i=e[n];return(n in t||ke(o=i)&&o[Ve]().matcherType==="optional")&&le(i,t[n],r);var o})}return Object.is(t,e)},vt=e=>new ce(e,[]);class ce{constructor(t,r){this.value=void 0,this.cases=void 0,this.value=t,this.cases=r}with(...t){const r=t[t.length-1],n=[t[0]],i=[];return t.length===3&&typeof t[1]=="function"?(n.push(t[0]),i.push(t[1])):t.length>2&&n.push(...t.slice(1,t.length-1)),new ce(this.value,this.cases.concat([{match:o=>{let u={};const $=Boolean(n.some(x=>le(x,o,(d,g)=>{u[d]=g}))&&i.every(x=>x(o)));return{matched:$,value:$&&Object.keys(u).length?Qe in u?u[Qe]:u:o}},handler:r}]))}when(t,r){return new ce(this.value,this.cases.concat([{match:n=>({matched:Boolean(t(n)),value:n}),handler:r}]))}otherwise(t){return new ce(this.value,this.cases.concat([{match:r=>({matched:!0,value:r}),handler:t}])).run()}exhaustive(){return this.run()}run(){let t,r=this.value;for(let n=0;n<this.cases.length;n++){const i=this.cases[n],o=i.match(this.value);if(o.matched){r=o.value,t=i.handler;break}}if(!t){let n;try{n=JSON.stringify(this.value)}catch{n=this.value}throw new Error(`Pattern matching error: no pattern matches value ${n}`)}return t(r,this.value)}}const an=(e=De)=>({type:"indicator",messageDelay:e}),ln=({messages:e,isLast:t})=>{const r=f.exports.useRef(t&&!!e.length),[n,i]=f.exports.useState(!r.current),[o,u]=f.exports.useState(r.current),[$,x]=f.exports.useState(r.current?[]:e),d=f.exports.useCallback(()=>{i(!0),u(!1)},[]);return f.exports.useEffect(()=>{if(!r)return;const g=e.flatMap(A=>[an(A.delay),{type:"message",message:A}]);let S;const _=(A,E)=>{if(E===0){A();return}S=setTimeout(()=>{A()},E)},b=()=>{if(!r.current)return;const A=g.shift();if(!A){d();return}vt(A).with({type:"message"},({message:E})=>{u(!1),x(V=>[...V,E]),_(b,De)}).with({type:"indicator"},({messageDelay:E=De})=>{u(!0),_(b,E)}).exhaustive()};return b(),()=>{clearTimeout(S)}},[]),rn(()=>{t||(r.current=!1,d(),x(e))},[t]),{complete:n,showIndicator:o,visibleMessages:$}},oe=H(F.SYSTEM_RESPONSE),_t=C(oe("div","actions"),{display:"flex",flexWrap:"wrap",marginBottom:8,padding:"0 $5 0 54px",[`& ${J.Container}`]:{height:"unset",paddingTop:7,paddingBottom:7,marginTop:8,marginRight:8,whiteSpace:"normal",textAlign:"start"}}),wt=C(oe("span","controls"),{position:"relative"}),We=C(oe("div"),{display:"flex",[`& ${G.Container}`]:{visibility:"hidden",alignSelf:"flex-end",margin:"0 8px 4px 0"},[`& ${ee.Container}`]:{alignSelf:"center",whiteSpace:"nowrap",marginLeft:8,opacity:"0%",trans:["opacity"]},[`&:hover ${ee.Container}`]:{opacity:"100%"},variants:{withImage:{true:{[`& ${G.Container}`]:{visibility:"visible"}}},scrollable:{true:{overflowX:"scroll",flexShrink:0,scrollbarWidth:"none","-ms-overflow-style":"none",["&::-webkit-scrollbar"]:{display:"none"}}},center:{true:{alignItems:"center"}}}}),cn=C(oe(We,"message")),dn=C(oe(We,"indicator")),bt=C(oe("div","list"),{display:"flex",flexDirection:"column",flexShrink:0,[`& ${ne.Container}`]:{marginBottom:"$1",maxWidth:248,"&:last-of-type":{marginBottom:0}},variants:{mode:{bubble:{[`& ${ne.Container}`]:{maxWidth:248}},embedded:{maxWidth:"calc(100% - 54px - 50px)",[`& ${ne.Container}`]:{maxWidth:"100%"}}}},defaultVariants:{mode:"bubble"}}),Ce=({avatar:e})=>R(dn,{withImage:!0,center:!0,children:[c(G,{avatar:e}),c(Wt,{})]}),At=Ce;try{Ce.displayName="Indicator",Ce.__docgenInfo={description:"",displayName:"Indicator",props:{avatar:{defaultValue:null,description:"",name:"avatar",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/components/SystemResponse/Indicator.tsx#Indicator"]={docgenInfo:Ce.__docgenInfo,name:"Indicator",path:"src/components/SystemResponse/Indicator.tsx#Indicator"})}catch{}const fe=42,Re=12,Tt=H(F.CAROUSEL),un=C(Tt("span","button"),{position:"absolute",zIndex:1,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"$round",trans:["background-color","box-shadow","opacity"],height:fe,width:fe,cursor:"pointer",backgroundColor:"$white",color:"$black",boxShadow:"0 1px 3px 1px $shadow1, 0 0 0 1px $shadow3, 0 2px 4px -3px $shadow12, 0 5px 8px -8px $shadow12",border:"none",[`& ${z.Frame}`]:{height:"$xxs",width:"$xxs",color:"rgba(0,0,0,0.6)",trans:["color"]},["&:hover"]:{boxShadow:"0 1px 4px 1px $shadow4, 0 0 0 1px $shadow4, 0 2px 4px -3px $shadow12, 0 5px 8px -8px $shadow12"},["&:active"]:{boxShadow:"0 1px 4px 1px $shadow8, 0 0 0 1px $shadow4, 0 2px 4px -3px $shadow12, 0 5px 8px -8px $shadow12"},[`
      &:hover ${z.Frame},
      &:active ${z.Frame}
    `]:{color:"rgba(0,0,0,0.8)"},variants:{visible:{true:{opacity:1,pointerEvents:"auto"},false:{opacity:0,pointerEvents:"none"}},alignment:{left:{left:48-fe/2},right:{right:70-fe/2,[`& ${z.Frame}`]:{transform:"scaleX(-1)"}}}}}),Ot=C(Tt("div"),{display:"flex",whiteSpace:"nowrap",[`& ${He.Container}`]:{height:"fit-content",flexShrink:0,marginLeft:Re,"&:first-of-type":{marginLeft:0}}}),de=f.exports.forwardRef(({onClick:e,alignment:t,visible:r,containerEl:n},i)=>c(un,{ref:i,alignment:t,visible:r,css:{transform:`translateY(calc(${n.clientHeight/2}px - 50%))`},onClick:e,children:c(z,{svg:"largeArrowLeft"})}));try{de.displayName="CarouselButton",de.__docgenInfo={description:"A button used to scroll to the previous or next Card in a Carousel.",displayName:"CarouselButton",props:{alignment:{defaultValue:null,description:"The end of the container where the button will be rendered.",name:"alignment",required:!0,type:{name:"enum",value:[{value:'"left"'},{value:'"right"'}]}},visible:{defaultValue:null,description:"If true then the button will be visible, otherwise hidden.",name:"visible",required:!0,type:{name:"boolean"}},containerEl:{defaultValue:null,description:"The buttons will be centered vertically based on the height of this element.",name:"containerEl",required:!0,type:{name:"HTMLElement"}},onClick:{defaultValue:null,description:"A click handler for the button.",name:"onClick",required:!1,type:{name:"MouseEventHandler<HTMLButtonElement>"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/components/Carousel/CarouselButton.tsx#CarouselButton"]={docgenInfo:de.__docgenInfo,name:"CarouselButton",path:"src/components/Carousel/CarouselButton.tsx#CarouselButton"})}catch{}const Ke=Kt+2,Rt=Ke/3,pn=Ke+Re+Rt,Te=Ke+Re,tt=(e,t)=>()=>{const r=e==null?void 0:e.current;if(!r)return;const n=t(r);r.scrollTo({left:n&&n*Te,behavior:"smooth"})},hn=(e,t,r)=>{const[n,i]=f.exports.useState(!1),[o,u]=f.exports.useState(!1),$=f.exports.useRef(null),x=f.exports.useRef(null),d=r.length>1;return f.exports.useEffect(()=>{!(t!=null&&t.current)||!d||u(!0)},[]),f.exports.useEffect(()=>{const g=e==null?void 0:e.current;if(!g||!d)return;const S=Te*r.length-Re,_=()=>{const{scrollLeft:b}=g;i(b>=Rt),u(b<=S-pn)};return g.addEventListener("scroll",_),()=>{g.removeEventListener("scroll",_)}},[]),{previousButtonRef:$,nextButtonRef:x,showPreviousButton:n,showNextButton:o}},ve=({cards:e,containerRef:t,controlsRef:r})=>{const{previousButtonRef:n,nextButtonRef:i,showPreviousButton:o,showNextButton:u}=hn(t,r,e),$=t==null?void 0:t.current,x=r==null?void 0:r.current,d=$&&x,g=tt(t,_=>Math.ceil(_.scrollLeft/Te)-1),S=tt(t,_=>Math.floor(_.scrollLeft/Te)+1);return R(ue,{children:[c(Ot,{children:e.map((_,b)=>f.exports.createElement(He,{..._,key:b}))}),d&&zt.exports.createPortal(R(ue,{children:[c(de,{ref:n,alignment:"left",visible:o,containerEl:$,onClick:g}),c(de,{ref:i,alignment:"right",visible:u,containerEl:$,onClick:S})]}),x)]})},mn=Object.assign(ve,{Container:Ot});try{ve.displayName="Carousel",ve.__docgenInfo={description:"A carousel of {@link Card} components that can be scrolled natively or with buttons.",displayName:"Carousel",props:{cards:{defaultValue:null,description:"A list of props objects which will be passed to {@link Card} components.",name:"cards",required:!0,type:{name:"CardProps[]"}},containerRef:{defaultValue:null,description:"A reference to the HTML element of a parent horizontal scrolling container.",name:"containerRef",required:!1,type:{name:"RefObject<HTMLDivElement>"}},controlsRef:{defaultValue:null,description:"A reference to an HTML element to anchor the carousel controls.",name:"controlsRef",required:!1,type:{name:"RefObject<HTMLSpanElement>"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/components/Carousel/index.tsx#Carousel"]={docgenInfo:ve.__docgenInfo,name:"Carousel",path:"src/components/Carousel/index.tsx#Carousel"})}catch{}const Ie=H(F.FEEDBACK),fn=C(Ie("div"),{display:"inline-flex",alignItems:"center",boxSizing:"border-box",marginTop:"8.5px"}),gn=C(Ie("div","description"),{color:"$darkGrey",marginRight:4,lineHeight:17,typo:{size:12}}),yn=C(Ie("div","buttons"),{display:"flex",gap:4}),nt=C(Ie("button","button"),{display:"inline-flex",backgroundColor:"transparent",border:0,borderRadius:"$round",width:24,height:24,padding:0,margin:0,cursor:"pointer",variants:{active:{false:{color:"rgb(115 115 118 / 85%)","&:hover":{color:"rgb(115 115 118 / 100%)"}},true:{color:"$white",backgroundColor:"$primary"}},orientation:{positive:{transform:"none"},negative:{transform:"rotate(180deg)"}}},defaultVariants:{active:!1,orientation:"positive"}}),xn=({question:e="Was this helpful?",onClick:t,...r})=>{const[n,i]=Nt.useState(null),o=u=>{u!==n&&(t(u),i(u))};return R(fn,{...r,children:[c(gn,{children:e}),R(yn,{children:[c(nt,{orientation:"positive",active:n===me.POSITIVE,onClick:()=>o(me.POSITIVE),children:c(Xe,{width:"24px",height:"24px"})}),c(nt,{orientation:"negative",active:n===me.NEGATIVE,onClick:()=>o(me.NEGATIVE),children:c(Xe,{width:"24px",height:"24px"})})]})]})},Sn=()=>{const e=f.exports.useContext(re);return f.exports.useEffect(()=>{e.setStatus(Le.ENDED)},[]),null};try{end.displayName="end",end.__docgenInfo={description:"",displayName:"end",props:{}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/components/SystemResponse/state/end.tsx#end"]={docgenInfo:end.__docgenInfo,name:"end",path:"src/components/SystemResponse/state/end.tsx#end"})}catch{}const _e=({avatar:e,feedback:t,timestamp:r,message:n,withImage:i,children:o})=>{const u=f.exports.useRef(null),$=f.exports.useRef(null),{config:x}=f.exports.useContext(re);return!o&&(n==null?void 0:n.type)===Q.END?c(Sn,{}):R(ue,{children:[c(wt,{ref:$}),R(cn,{ref:u,withImage:i,scrollable:(n==null?void 0:n.type)===Q.CAROUSEL,children:[c(G,{avatar:e}),R(bt,{mode:x.render.mode,children:[o!=null?o:vt(n).with({type:Q.TEXT},({text:d})=>c(Jt,{text:d})).with({type:Q.IMAGE},({url:d})=>{var g;return c(Gt,{image:d,mode:(g=x.render)==null?void 0:g.mode})}).with({type:Q.CARD},d=>c(He,{...Ze(d,["type"])})).with({type:Q.CAROUSEL},d=>c(mn,{...Ze(d,["type"]),containerRef:u,controlsRef:$})).otherwise(()=>null),t&&c(xn,{...t})]}),c(ee,{value:r})]})]})},It=_e;try{_e.displayName="SystemMessage",_e.__docgenInfo={description:"",displayName:"SystemMessage",props:{avatar:{defaultValue:null,description:"An image URL for an avatar to associate this message with.",name:"avatar",required:!0,type:{name:"string"}},timestamp:{defaultValue:null,description:"A unix timestamp indicating when this message was sent.",name:"timestamp",required:!0,type:{name:"number"}},message:{defaultValue:null,description:"A single message to render with a {@link Message } component.",name:"message",required:!1,type:{name:"MessageProps"}},withImage:{defaultValue:null,description:"If true, renders an avatar next to the message.",name:"withImage",required:!0,type:{name:"boolean"}},feedback:{defaultValue:{value:"false"},description:"If provided, will display {@link Feedback} component.",name:"feedback",required:!1,type:{name:"FeedbackProps"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/components/SystemResponse/SystemMessage.tsx#SystemMessage"]={docgenInfo:_e.__docgenInfo,name:"SystemMessage",path:"src/components/SystemResponse/SystemMessage.tsx#SystemMessage"})}catch{}const we=({feedback:e,avatar:t,timestamp:r,messages:n,actions:i=[],isLast:o,Message:u=It})=>{const $=f.exports.useContext(re),{showIndicator:x,visibleMessages:d,complete:g}=ln({messages:n,isLast:o});return Ct([x,g,d.length]),!n.length&&!i.length?null:R(ue,{children:[d.map((S,_)=>c(u,{message:S,withImage:!x&&_===d.length-1,feedback:g&&!x&&_===d.length-1?e:void 0,avatar:t,timestamp:r},_)),o&&g&&!!i.length&&c(_t,{children:i.map(({request:S,name:_},b)=>c(J,{variant:"secondary",onClick:()=>$==null?void 0:$.interact(S,_),children:_},b))}),x&&c(At,{avatar:t})]})},P=Object.assign(we,{Message:Q,Container:We,Controls:wt,List:bt,Actions:_t,Indicator:At,SystemMessage:It});try{we.displayName="SystemResponse",we.__docgenInfo={description:"A dynamic component capable of displaying all standard system responses.",displayName:"SystemResponse",props:{avatar:{defaultValue:null,description:"An image URL for an avatar to associate the messages with.",name:"avatar",required:!0,type:{name:"string"}},timestamp:{defaultValue:null,description:"A unix timestamp indicating when the messages were sent.",name:"timestamp",required:!0,type:{name:"number"}},messages:{defaultValue:null,description:"A list of messages that will be rendered as {@link SystemMessage} components.",name:"messages",required:!0,type:{name:"MessageProps[]"}},actions:{defaultValue:{value:"[]"},description:"A list of actions that will be rendered as buttons.",name:"actions",required:!1,type:{name:"ResponseActionProps[]"}},isLast:{defaultValue:null,description:`If true, allows actions to appear after this message.
Only the last system message in a row can show actions.`,name:"isLast",required:!1,type:{name:"boolean"}},feedback:{defaultValue:{value:"false"},description:"If provided, will display {@link Feedback} component under the last message.",name:"feedback",required:!1,type:{name:"FeedbackProps"}},Message:{defaultValue:null,description:"Override the rendering of individual messages.",name:"Message",required:!1,type:{name:"ComponentType<SystemMessageProps>"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/components/SystemResponse/index.tsx#SystemResponse"]={docgenInfo:we.__docgenInfo,name:"SystemResponse",path:"src/components/SystemResponse/index.tsx#SystemResponse"})}catch{}const ze=H(F.USER_RESPONSE),Et=C(ze("aside","debug"),{typo:{size:"12px",height:"17px"},color:"$darkGrey",marginTop:"$2"}),Mt=C(ze("div"),{display:"flex",flexDirection:"column",flexShrink:0,alignItems:"flex-end",[`& > ${at.Container}`]:{marginTop:"$1"},variants:{mode:{bubble:{[`& ${ne.Container}`]:{maxWidth:282}},embedded:{[`& ${ne.Container}`]:{maxWidth:"80%"}}}},defaultVariants:{mode:"bubble"}}),kt=C(ze("div","row"),{display:"flex",width:"100%",alignItems:"center",[`& ${ee.Container}`]:{flexGrow:1,marginRight:8,textAlign:"end",opacity:"0%",trans:["opacity"]},[`&:hover ${ee.Container}`]:{opacity:"100%"}}),be=({message:e,timestamp:t,debug:r})=>{var i,o;Ct();const{config:n}=f.exports.useContext(re);return R(Mt,{mode:n.render.mode,children:[R(kt,{children:[c(ee,{value:t}),c(ne,{from:"user",mode:n.render.mode,children:e})]}),r&&R(ue,{children:[c(Et,{children:r.message}),r.reason&&c(at,{label:(i=r.action)==null?void 0:i.label,onClick:(o=r.action)==null?void 0:o.onClick,orientation:"right",children:r.reason})]})]})},Z=Object.assign(be,{Container:Mt,Debug:Et,Row:kt});try{be.displayName="UserResponse",be.__docgenInfo={description:"A user-sent text response.",displayName:"UserResponse",props:{message:{defaultValue:null,description:"The message text to display.",name:"message",required:!0,type:{name:"string"}},timestamp:{defaultValue:null,description:"A unix timestamp indicating when this response was sent.",name:"timestamp",required:!0,type:{name:"number"}},debug:{defaultValue:null,description:'If provided, adds a caption and optional "debug" message with an action.',name:"debug",required:!1,type:{name:"DebugResponseProps"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/components/UserResponse/index.tsx#UserResponse"]={docgenInfo:be.__docgenInfo,name:"UserResponse",path:"src/components/UserResponse/index.tsx#UserResponse"})}catch{}const Be=10,se=H(F.CHAT),Oe=C(se("div","overlay"),{position:"absolute",top:0,bottom:0,left:0,right:0,backgroundColor:"$shadow12"}),Ye=C(se("article"),{position:"relative",display:"flex",overflow:"hidden",flexDirection:"column",backgroundColor:"$white",[`& > ${ot}`]:{margin:"auto"},[`& ${yt.Container}`]:{animation:`${Ht} 150ms ease forwards`},[`& ${mt.Container}`]:{...rt({duration:300,delay:300})},[`& ${Oe}`]:{opacity:0,pointerEvents:"none",trans:["opacity"]},[`& ${$e.Container}`]:{position:"absolute",bottom:0,width:"100%",boxSizing:"border-box",paddingBottom:`calc($3 + ${Be}px)`,transition:`transform 320ms cubic-bezier(0.45, 1.29, 0.64, 1), ${Ft(["box-shadow"],300)}`,transform:`translateY(calc(100% + ${Be}px))`},variants:{withPrompt:{true:{[`& ${Oe}`]:{opacity:1,zIndex:2,pointerEvents:"auto"},[`& ${$e.Container}`]:{zIndex:3,transform:`translateY(${Be}px)`}},false:{[`& ${$e.Container}`]:{boxShadow:"none"}}}}}),Bt={display:"flex",justifyContent:"center",typo:{size:12},color:"$darkGrey"},Ge=C(se("div","status"),{...Bt}),$n=C(se("span","session-time"),{...Bt,paddingBottom:"$3"}),Lt=C(se("main","dialog"),{display:"flex",flexDirection:"column",height:"100%",overflowY:"scroll",overflowX:"hidden",paddingBottom:"$3",[`
    & ${Z.Container},
    & ${P.List},
    & ${P.Actions},
    & ${dt.Container}
  `]:{...rt({duration:150,delay:0})},[`
    & > ${Z.Container},
    & > ${P.Container}
  `]:{padding:"0 $5"},[`& > ${P.Actions}`]:{padding:"0 $5 0 54px"},[`& ${P.Container}`]:{marginBottom:"$1","&:last-of-type":{marginBottom:0}},[`& ${Z.Container} + ${Z.Container}`]:{marginTop:"$1"},[`
    & ${P.Container} + ${Z.Container},
    & ${P.Actions} + ${Z.Container},
    & ${Z.Container} + ${P.Controls} + ${P.Container}
  `]:{marginTop:"$5"},[`& ${ee.Container}`]:{width:50},[`& ${Ge}`]:{marginTop:"$3",marginBottom:8}}),Dt=C(se("div","spacer"),{flexGrow:1}),Ae=({hasEnded:e,title:t,image:r,avatar:n,description:i,startTime:o,isLoading:u,withWatermark:$,autostart:x,onMinimize:d,onEnd:g,onStart:S,onSend:_,children:b})=>{const A=nn(o),E=f.exports.useRef(null),[V,q]=f.exports.useState(!1),{config:U}=f.exports.useContext(re),X=f.exports.useContext(Pe);f.exports.useEffect(()=>{x&&(S==null||S())},[x]);const N=D=>{e?g==null||g(D):q(!0)},M=()=>q(!1),k=f.exports.useMemo(()=>{var D;return((D=U.render)==null?void 0:D.mode)===Yt.BUBBLE?[{svg:"minus",onClick:d},{svg:"close",onClick:N}]:[{svg:"close",onClick:N}]},[U,N,d]);return u?c(Ye,{children:c(ot,{})}):R(Ye,{withPrompt:V,children:[c(yt,{title:t,image:r,actions:k}),c(Lt,{ref:E,children:R(Pt,{target:E,children:[c(dt,{title:t,avatar:n,description:i}),c(Dt,{}),!!A&&!!X.session.turns.length&&c($n,{children:A}),b,e&&c(Ge,{children:"You have ended the chat"})]})}),c(mt,{withWatermark:$,hasEnded:e,onStart:S,onSend:_}),c(Oe,{}),c($e,{accept:{label:"End Chat",type:"warn",onClick:jt(g,M)},cancel:{label:"Cancel",onClick:M}})]})},Fn=Object.assign(f.exports.memo(Ae),{Container:Ye,Dialog:Lt,Overlay:Oe,Spacer:Dt,Status:Ge});try{Ae.displayName="Chat",Ae.__docgenInfo={description:"A full chat dialog with header, footer, overlay and auto-scrolling content.",displayName:"Chat",props:{}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/components/Chat/index.tsx#Chat"]={docgenInfo:Ae.__docgenInfo,name:"Chat",path:"src/components/Chat/index.tsx#Chat"})}catch{}export{dt as A,Fn as C,mt as F,yt as H,vt as K,$e as P,P as S,Z as U,mn as a,Ze as o,sn as u};
//# sourceMappingURL=index.c61c8f15.js.map
